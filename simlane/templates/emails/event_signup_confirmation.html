{% load i18n %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% blocktrans with event_name=signup_entry.signup.event.name %}Confirmation: {{ event_name }} Signup{% endblocktrans %}</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        line-height: 1.6;
        color: #333;
        background-color: #f8fafc;
      }

      .email-container {
        max-width: 600px;
        margin: 0 auto;
        background-color: #ffffff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }

      .header {
        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        color: white;
        padding: 40px 30px;
        text-align: center;
      }

      .header img {
        max-width: 120px;
        height: auto;
        margin-bottom: 20px;
      }

      .header h1 {
        font-size: 28px;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .header p {
        font-size: 16px;
        opacity: 0.9;
      }

      .content {
        padding: 40px 30px;
      }

      .greeting {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 20px;
        color: #2d3748;
      }

      .event-hero {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 12px;
        padding: 30px;
        color: white;
        text-align: center;
        margin: 25px 0;
        position: relative;
        overflow: hidden;
      }

      .event-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: url('{{ signup_entry.signup.event.track.image.url }}');
        background-size: cover;
        background-position: center;
        opacity: 0.2;
        z-index: 0;
      }

      .event-hero-content {
        position: relative;
        z-index: 1;
      }

      .event-title {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 10px;
      }

      .event-subtitle {
        font-size: 16px;
        opacity: 0.9;
        margin-bottom: 20px;
      }

      .event-details-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .event-detail {
        text-align: center;
      }

      .event-detail-label {
        font-size: 12px;
        opacity: 0.8;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .event-detail-value {
        font-size: 16px;
        font-weight: 600;
      }

      .signup-summary {
        background-color: #f7fafc;
        border-radius: 8px;
        padding: 25px;
        margin: 25px 0;
      }

      .signup-summary h3 {
        color: #2d3748;
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
      }

      .signup-summary h3::before {
        content: 'âœ“';
        background-color: #48bb78;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: 700;
        margin-right: 10px;
      }

      .signup-detail {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 12px 0;
        border-bottom: 1px solid #e2e8f0;
      }

      .signup-detail:last-child {
        border-bottom: none;
      }

      .signup-detail-label {
        font-weight: 600;
        color: #4a5568;
      }

      .signup-detail-value {
        color: #2d3748;
        font-weight: 500;
      }

      .role-badge {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .role-driver {
        background-color: #bee3f8;
        color: #2b6cb0;
      }

      .role-spectator {
        background-color: #e9d8fd;
        color: #6b46c1;
      }

      .car-info {
        display: flex;
        align-items: center;
      }

      .car-image {
        width: 40px;
        height: 24px;
        object-fit: cover;
        border-radius: 4px;
        margin-right: 8px;
      }

      .next-steps {
        background-color: #edf2f7;
        border-radius: 8px;
        padding: 25px;
        margin: 25px 0;
      }

      .next-steps h3 {
        color: #2d3748;
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .steps-list {
        list-style: none;
        counter-reset: step-counter;
      }

      .steps-list li {
        counter-increment: step-counter;
        margin-bottom: 15px;
        display: flex;
        align-items: flex-start;
      }

      .steps-list li::before {
        content: counter(step-counter);
        background-color: #667eea;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 700;
        margin-right: 12px;
        flex-shrink: 0;
        margin-top: 2px;
      }

      .availability-matrix {
        background-color: #f7fafc;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .availability-matrix h4 {
        color: #2d3748;
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 15px;
      }

      .availability-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
        border-bottom: 1px solid #e2e8f0;
      }

      .availability-item:last-child {
        border-bottom: none;
      }

      .availability-status {
        display: flex;
        align-items: center;
      }

      .availability-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        margin-right: 8px;
      }

      .available {
        background-color: #48bb78;
      }

      .unavailable {
        background-color: #f56565;
      }

      .action-button {
        display: inline-block;
        background-color: #667eea;
        color: white;
        padding: 15px 30px;
        text-decoration: none;
        border-radius: 8px;
        font-weight: 600;
        font-size: 16px;
        text-align: center;
        margin: 20px 0;
        transition: all 0.3s ease;
      }

      .action-button:hover {
        background-color: #5a67d8;
        transform: translateY(-1px);
      }

      .important-dates {
        background-color: #fef5e7;
        border: 1px solid #f6e05e;
        border-radius: 8px;
        padding: 20px;
        margin: 25px 0;
      }

      .important-dates h4 {
        color: #d69e2e;
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
      }

      .important-dates h4::before {
        content: 'ðŸ“…';
        margin-right: 8px;
      }

      .date-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 0;
      }

      .footer {
        background-color: #edf2f7;
        padding: 30px;
        text-align: center;
        color: #718096;
        font-size: 14px;
      }

      .footer a {
        color: #667eea;
        text-decoration: none;
      }

      .footer a:hover {
        text-decoration: underline;
      }

      @media (max-width: 480px) {
        .email-container {
          margin: 0;
          box-shadow: none;
        }

        .header,
        .content,
        .footer {
          padding: 20px;
        }

        .header h1 {
          font-size: 24px;
        }

        .event-details-grid {
          grid-template-columns: 1fr;
          gap: 15px;
        }

        .signup-detail {
          flex-direction: column;
          align-items: flex-start;
          gap: 5px;
        }
      }
    </style>
  </head>
  <body>
    <div class="email-container">
      <!-- Header -->
      <div class="header">
        <img src="https://simlane.com/static/images/logo_inverted.png"
             alt="SimLane" />
        <h1>{% trans "Signup Confirmed!" %}</h1>
        <p>{% trans "You're registered for the race!" %}</p>
      </div>
      <!-- Content -->
      <div class="content">
        <div class="greeting">
          {% blocktrans with user_name=signup_entry.user.get_full_name|default:signup_entry.user.username %}
                    Hi {{ user_name }}!
                {% endblocktrans %}
        </div>
        <p>
          {% blocktrans with event_name=signup_entry.signup.event.name club_name=signup_entry.signup.club.name %}
                    Great news! Your signup for <strong>{{ event_name }}</strong> with <strong>{{ club_name }}</strong> has been confirmed.
                {% endblocktrans %}
        </p>
        <!-- Event Hero -->
        <div class="event-hero">
          <div class="event-hero-content">
            <div class="event-title">{{ signup_entry.signup.event.name }}</div>
            <div class="event-subtitle">{{ signup_entry.signup.event.track.name }}</div>
            <div class="event-details-grid">
              <div class="event-detail">
                <div class="event-detail-label">{% trans "Date" %}</div>
                <div class="event-detail-value">{{ signup_entry.signup.event.start_time|date:"M j" }}</div>
              </div>
              <div class="event-detail">
                <div class="event-detail-label">{% trans "Time" %}</div>
                <div class="event-detail-value">{{ signup_entry.signup.event.start_time|date:"g:i A" }}</div>
              </div>
              <div class="event-detail">
                <div class="event-detail-label">{% trans "Duration" %}</div>
                <div class="event-detail-value">{{ signup_entry.signup.event.duration_minutes }}min</div>
              </div>
              <div class="event-detail">
                <div class="event-detail-label">{% trans "Simulator" %}</div>
                <div class="event-detail-value">{{ signup_entry.signup.event.simulator.name }}</div>
              </div>
            </div>
          </div>
        </div>
        <!-- Signup Summary -->
        <div class="signup-summary">
          <h3>{% trans "Your Signup Details" %}</h3>
          <div class="signup-detail">
            <span class="signup-detail-label">{% trans "Role" %}</span>
            <span class="signup-detail-value">
              <span class="role-badge role-{{ signup_entry.role_preference|lower }}">
                {{ signup_entry.get_role_preference_display }}
              </span>
            </span>
          </div>
          {% if signup_entry.preferred_sim_car %}
            <div class="signup-detail">
              <span class="signup-detail-label">{% trans "Preferred Car" %}</span>
              <span class="signup-detail-value">
                <div class="car-info">
                  {% if signup_entry.preferred_sim_car.image %}
                    <img src="{{ signup_entry.preferred_sim_car.image.url }}"
                         alt="{{ signup_entry.preferred_sim_car.name }}"
                         class="car-image" />
                  {% endif %}
                  {{ signup_entry.preferred_sim_car.name }}
                </div>
              </span>
            </div>
          {% endif %}
          {% if signup_entry.backup_sim_car %}
            <div class="signup-detail">
              <span class="signup-detail-label">{% trans "Backup Car" %}</span>
              <span class="signup-detail-value">{{ signup_entry.backup_sim_car.name }}</span>
            </div>
          {% endif %}
          {% if signup_entry.notes %}
            <div class="signup-detail">
              <span class="signup-detail-label">{% trans "Notes" %}</span>
              <span class="signup-detail-value">"{{ signup_entry.notes }}"</span>
            </div>
          {% endif %}
          <div class="signup-detail">
            <span class="signup-detail-label">{% trans "Registered On" %}</span>
            <span class="signup-detail-value">{{ signup_entry.created_at|date:"F j, Y \a\t g:i A T" }}</span>
          </div>
        </div>
        <!-- Availability Summary -->
        {% if signup_entry.availabilities.exists %}
          <div class="availability-matrix">
            <h4>{% trans "Your Availability" %}</h4>
            {% for availability in signup_entry.availabilities.all %}
              <div class="availability-item">
                <span>
                  {{ availability.time_slot.session_type }} -
                  {{ availability.time_slot.start_time|date:"M j, g:i A" }}
                </span>
                <div class="availability-status">
                  <div class="availability-indicator {% if availability.available %}available{% else %}unavailable{% endif %}"></div>
                  {% if availability.available %}
                    {% trans "Available" %}
                    {% if availability.preferred_stint_duration %}({{ availability.preferred_stint_duration }}min stints){% endif %}
                  {% else %}
                    {% trans "Unavailable" %}
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          </div>
        {% endif %}
        <!-- Important Dates -->
        <div class="important-dates">
          <h4>{% trans "Important Dates" %}</h4>
          <div class="date-item">
            <span><strong>{% trans "Signup Deadline" %}</strong></span>
            <span>{{ signup_entry.signup.signup_deadline|date:"M j, Y \a\t g:i A" }}</span>
          </div>
          <div class="date-item">
            <span><strong>{% trans "Race Date" %}</strong></span>
            <span>{{ signup_entry.signup.event.start_time|date:"M j, Y \a\t g:i A" }}</span>
          </div>
          {% if signup_entry.signup.team_allocation_date %}
            <div class="date-item">
              <span><strong>{% trans "Team Allocation" %}</strong></span>
              <span>{{ signup_entry.signup.team_allocation_date|date:"M j, Y" }}</span>
            </div>
          {% endif %}
        </div>
        <!-- Next Steps -->
        <div class="next-steps">
          <h3>{% trans "What Happens Next?" %}</h3>
          <ol class="steps-list">
            <li>
              <div>
                <strong>{% trans "Wait for More Signups" %}</strong>
                <br />
                {% trans "Other club members have until the signup deadline to register for this event." %}
              </div>
            </li>
            <li>
              <div>
                <strong>{% trans "Team Allocation" %}</strong>
                <br />
                {% trans "After the signup deadline, teams will be allocated and you'll receive your team assignment." %}
              </div>
            </li>
            <li>
              <div>
                <strong>{% trans "Team Planning" %}</strong>
                <br />
                {% trans "Work with your team to plan stint assignments and pit strategy before race day." %}
              </div>
            </li>
            <li>
              <div>
                <strong>{% trans "Race Day" %}</strong>
                <br />
                {% trans "Show up ready to race and have fun with your team!" %}
              </div>
            </li>
          </ol>
        </div>
        <!-- Action Button -->
        <div style="text-align: center;">
          <a href="{{ event_url }}" class="action-button">{% trans "View Event Details" %}</a>
        </div>
        <!-- Update/Cancel Info -->
        <div style="background-color: #f7fafc;
                    border-radius: 8px;
                    padding: 20px;
                    margin-top: 25px;
                    text-align: center">
          <p style="color: #4a5568; margin-bottom: 15px;">{% trans "Need to make changes to your signup?" %}</p>
          <div style="display: flex;
                      justify-content: center;
                      gap: 15px;
                      flex-wrap: wrap">
            <a href="{{ update_signup_url }}"
               style="color: #667eea;
                      text-decoration: none;
                      font-weight: 600">{% trans "Update Signup" %}</a>
            <span style="color: #cbd5e0;">|</span>
            <a href="{{ cancel_signup_url }}"
               style="color: #f56565;
                      text-decoration: none;
                      font-weight: 600">{% trans "Cancel Signup" %}</a>
          </div>
        </div>
      </div>
      <!-- Footer -->
      <div class="footer">
        <p>
          {% trans "This confirmation was sent from" %} <a href="https://simlane.com">SimLane</a>
          <br />
          {% blocktrans with club_name=signup_entry.signup.club.name %}You received this email because you signed up for an event with {{ club_name }}.{% endblocktrans %}
        </p>
        <p style="margin-top: 15px;">
          <a href="{{ unsubscribe_url }}">{% trans "Unsubscribe from event notifications" %}</a> |
          <a href="mailto:support@simlane.com">{% trans "Contact Support" %}</a>
        </p>
        <p style="margin-top: 15px; font-size: 12px; color: #a0aec0;">
          {% trans "SimLane - The ultimate platform for sim racing clubs and communities" %}
        </p>
      </div>
    </div>
  </body>
</html>
