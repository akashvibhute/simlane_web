{% load static i18n %}

{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
  <head>
    <title>
      {% block title %}
        SimLane
      {% endblock title %}
    </title>
    {% include 'components/head.html' %}
  </head>
  <body hx-headers='{"x-csrftoken": "{{ csrf_token }}"}'
        class="{% block bodyclass %}bg-gray-50 min-h-screen flex flex-col{% endblock bodyclass %}">
    {% block body %}
      <div class="flex-grow flex flex-col">
        <div class="mb-4">{% include 'components/navbar.html' %}</div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
          {% include 'components/messages.html' %}
          <main id="main-content">
            {% block main %}
              {% block content %}
                <div class="text-center py-12">
                  <p class="text-lg text-gray-600">Use this document as a way to quick start any new project.</p>
                </div>
              {% endblock content %}
            {% endblock main %}
          </main>
        </div>
      </div>
      {% include 'components/footer.html' %}
    {% endblock body %}
    {% block modal %}
    {% endblock modal %}
    {% block inline_javascript %}
      <script>
        function toggleMobileMenu() {
          const menu = document.getElementById('mobile-menu');
          menu.classList.toggle('hidden');
        }

        function toggleUserDropdown() {
          const dropdown = document.getElementById('user-dropdown');
          const arrow = document.getElementById('dropdown-arrow');
          const button = document.getElementById('user-dropdown-button');

          if (dropdown.classList.contains('hidden')) {
            // Show dropdown
            dropdown.classList.remove('hidden');
            // Trigger reflow to ensure transition works
            dropdown.offsetHeight;
            dropdown.classList.remove('opacity-0', 'scale-95');
            dropdown.classList.add('opacity-100', 'scale-100');
            arrow.style.transform = 'rotate(180deg)';
            button.setAttribute('aria-expanded', 'true');
          } else {
            // Hide dropdown
            dropdown.classList.remove('opacity-100', 'scale-100');
            dropdown.classList.add('opacity-0', 'scale-95');
            arrow.style.transform = 'rotate(0deg)';
            button.setAttribute('aria-expanded', 'false');
            // Wait for transition to complete before hiding
            setTimeout(() => {
              dropdown.classList.add('hidden');
            }, 100);
          }
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
          const dropdown = document.getElementById('user-dropdown');
          const button = document.getElementById('user-dropdown-button');

          if (dropdown && button && !button.contains(event.target) && !dropdown.contains(event.target)) {
            if (!dropdown.classList.contains('hidden')) {
              toggleUserDropdown();
            }
          }
        });

        // Close dropdown on escape key
        document.addEventListener('keydown', function(event) {
          if (event.key === 'Escape') {
            const dropdown = document.getElementById('user-dropdown');
            if (dropdown && !dropdown.classList.contains('hidden')) {
              toggleUserDropdown();
            }
          }
        });
      </script>
      {% comment %}
    Script tags with only code, no src (defer by default). To run
    with a "defer" so that you run inline code:
    <script>
      window.addEventListener('DOMContentLoaded', () => {
        /* Run whatever you want */
      });
    </script>
      {% endcomment %}
    {% endblock inline_javascript %}
  </body>
</html>
